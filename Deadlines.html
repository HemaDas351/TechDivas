<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Deadlines - Admin Dashboard</title>
  <link rel="stylesheet" href="admin.css" />
</head>
<body>
  <div class="container">
    <aside class="sidebar">
      <h2>Admin Panel</h2>
      <nav>
        <ul>
          <li><a href="Clients.html">Clients</a></li>
          <li><a href="Deadlines.html">Deadlines</a></li>
          <li><a href="Tickets.html">Tickets</a></li>
          <li><a href="Progress.html">Progress</a></li>
        </ul>
      </nav>
    </aside>

    <main class="main-content">
      <section class="card">
        <h3>Upcoming Deadlines</h3>
        <table>
          <thead>
            <tr>
              <th>Client</th>
              <th>Task</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Sanjukta Deka</td>
              <td>Submit project proposal</td>
              <td>2025-07-25</td>
            </tr>
            <tr>
              <td>Mariam Ahmed</td>
              <td>Finalize UI mockups</td>
              <td>2025-07-28</td>
            </tr>
          </tbody>
        </table>
      </section>
    </main>
  </div>
  <script>
  document.addEventListener("DOMContentLoaded", async () => {
    const token = localStorage.getItem("token");

    if (!token) {
      alert("Please log in first.");
      window.location.href = "login.html";
      return;
    }

    try {
      const response = await fetch("http://localhost:5000/deadline/get", {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${token}`,
        },
      });

      const data = await response.json();

      if (response.ok) {
        const container = document.querySelector("#deadlines-container");
        container.innerHTML = "";

        if (data.length === 0) {
          container.innerHTML = "<p>No deadlines available.</p>";
        } else {
          data.forEach((deadline) => {
            const div = document.createElement("div");
            div.className = "deadline-card";
            div.innerHTML = `
              <h4>${deadline.title}</h4>
              <p>Due: ${new Date(deadline.dueDate).toLocaleDateString()}</p>
              <p>Status: ${deadline.status}</p>
            `;
            container.appendChild(div);
          });
        }
      } else {
        alert(data.message || "Failed to fetch deadlines.");
      }
    } catch (error) {
      console.error("Error fetching deadlines:", error);
      alert("An error occurred while fetching deadlines.");
    }
  });
</script>
  <script src="deadlines.js"></script>
</body>
</html>
